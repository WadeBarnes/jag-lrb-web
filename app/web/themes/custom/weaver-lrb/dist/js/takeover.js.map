{"version":3,"sources":["../../js/takeover.js"],"names":["$","Drupal","behaviors","weaver_takeover","activateTakeover","type","button","cover","weaverTakeover","addEventListener","e","preventDefault","toggleTakeover","document","code","target","checkOpen","onclick","checkClosed","querySelector","classList","contains","mobileTakeoverChanges","takeover","childNav","parentLinks","querySelectorAll","forEach","parentLink","parentNode","toggle","body","header","getElementById","sideMenu","toggleButton","icon","weaver_animations","morphIcons","toggleTrueFalse","tooltip","trapFocus","element","attribute","attributeStatus","getAttribute","setAttribute","takeoverMenuLinks","link","attach","context","settings","once","each","add","takeoverButton","takeoverCover","tabHandle","ie","navigator","userAgent","match","removeAttribute","footerMenu","footerPosition","getBoundingClientRect","top","window","pageYOffset","documentElement","animate","scrollTop","exception","disengage","ally","maintain","tabFocus","mobileToggler","takeoverSearch","searchButtons","searchCover","setTimeout","remove","searchButton","innerWidth","jQuery"],"mappings":"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","sourcesContent":["// special JS for the takeover menu\n\n(function ($, Drupal) {\n\n  'use strict';\n\n  Drupal.behaviors.weaver_takeover = {\n\n    activateTakeover: function(type, button, cover) {\n      const weaverTakeover = Drupal.behaviors.weaver_takeover;\n\n      // takeoverMenu icon change\n      button.addEventListener('click', function(e) {\n        e.preventDefault();\n        weaverTakeover.toggleTakeover(type, button, cover);\n      });\n\n      document.addEventListener('keydown', function(e) {\n        if (e.code == 'Enter' && e.target == button) {\n          weaverTakeover.toggleTakeover(type, button, cover);\n        }\n        if (e.code == 'Escape' && weaverTakeover.checkOpen(type)) {\n          weaverTakeover.toggleTakeover(type, button, cover);\n        }\n      });\n\n      // actions when takeoverCover clicked\n      if (cover) {\n        cover.onclick = function(e) {\n          e.preventDefault();\n          weaverTakeover.toggleTakeover(type, button, cover);\n        };\n      }\n    },\n\n    checkClosed: function(type) {\n        if (document.querySelector('body').classList.contains('takeover-' + type + '-open')) {\n            return false;\n        }\n        return true;\n    },\n\n    checkOpen: function(type) {\n        if (document.querySelector('body').classList.contains('takeover-' + type + '-open')) {\n            return true;\n        }\n        return false;\n    },\n\n    mobileTakeoverChanges: function(takeover) {\n      let childNav;\n      let parentLinks = takeover.querySelectorAll('ul.nav > li.nav-item > .nav-link');\n      \n      if (parentLinks) {\n        parentLinks.forEach((parentLink) => {\n          parentLink.addEventListener('click', (e) => {\n            childNav = parentLink.parentNode.querySelector('ul.menu');\n            if (childNav != null) {\n              e.preventDefault();\n              childNav.classList.toggle('active');\n            }\n          });\n        });\n      }\n    },\n\n    toggleTakeover: function(type, button, cover) {\n      const weaverTakeover = Drupal.behaviors.weaver_takeover;\n\n      const body = document.querySelector('body');\n      const header = document.getElementById('header');\n      const sideMenu = document.getElementById('side-menu');\n      let takeover = document.getElementById('takeover-' + type);\n      let toggleButton;\n      let icon;\n\n      // ensure all other takeovers are closed\n      switch (type) {\n        case 'menu':\n          toggleButton = document.querySelector('#takeover-button a');\n\n          if (this.checkOpen('search')) {\n            this.toggleTakeover('search', button, cover);\n           }\n          icon = 'bars';\n                      \n          break;\n  \n        case 'search':\n          toggleButton = document.querySelector('#search-button a');\n\n          if (this.checkOpen('menu')) {\n            this.toggleTakeover('menu', button, cover);\n          }\n          icon = 'search';\n\n          break;\n      }\n\n      // animate icon\n      Drupal.behaviors.weaver_animations.morphIcons(icon, 'close');\n\n      // expand/collapse menu\n      body.classList.toggle('takeover-' + type + '-open');\n      body.classList.toggle('takeover-' + type + '-closed');\n\n      // take care of accessibility\n      this.toggleTrueFalse(takeover, 'aria-hidden');\n      this.toggleTrueFalse(toggleButton, 'aria-expanded');\n\n      // close tooltips\n      $('[data-toggle=\"tooltip\"]').tooltip('hide');\n      \n      this.trapFocus(type);\n    },\n\n    toggleTrueFalse: function(element, attribute) {\n\n        let attributeStatus = element.getAttribute(attribute);\n\n        if (attributeStatus == 'true') {\n          element.setAttribute(attribute, 'false');\n        } else {\n          element.setAttribute(attribute, 'true');\n        }\n    },\n\n    trapFocus: function(type) {\n\n      const takeoverMenuLinks = document.getElementById('takeover-menu').querySelectorAll('a.nav-link');\n\n      // put all menu items into or out of tabindex\n      if (this.checkOpen(type)) {\n\n        switch (type) {\n\n          case 'menu':\n\n            takeoverMenuLinks.forEach((link) => {\n                link.setAttribute('tabindex', 0);\n            });\n\n            break;\n        }\n\n      } else {\n\n        switch (type) {\n\n          case 'menu':\n            takeoverMenuLinks.forEach((link) => {\n                link.setAttribute('tabindex', -1);\n            });\n\n            break;\n        }\n      }\n    },\n\n    attach: function (context, settings) {\n\n      // ensures javascript runs only once per page load and not with every ajax call\n      $('body', context).once('weaver_takeover').each(function () { \n      \t\n        const weaverTakeover = Drupal.behaviors.weaver_takeover;\n\n        // add closed classes\n        const body = document.querySelector('body');\n        body.classList.add('takeover-menu-closed');\n        body.classList.add('takeover-search-closed');\n\n        // MENU\n        let takeover = document.getElementById('takeover-menu');\n        let takeoverButton = document.getElementById('takeover-button').querySelector('a[data-target=takeover-menu]');\n        let takeoverCover = document.getElementById('takeover-menu-cover');\n       \n      \tif (takeover) {\n\n      \t\tif (takeoverButton) {\n            weaverTakeover.activateTakeover('menu', takeoverButton, takeoverCover);\n          }\n\n          var tabHandle;\n          takeoverButton.addEventListener('click', function(e) {\n            e.preventDefault();\n\n            // IE fix, turns link into anchor to footer\n            var ie = 0;\n            try { \n              ie = navigator.userAgent.match( /(MSIE |Trident.*rv[ :])([0-9]+)/ )[ 2 ];\n              if (ie !== 0) {\n                takeoverButton.removeAttribute('data-target');\n                takeoverButton.removeAttribute('href');\n               \n                let footerMenu = document.getElementById('footer-menu');\n                let footerPosition = footerMenu.getBoundingClientRect().top + window.pageYOffset - 150;\n                $([document.documentElement, document.body]).animate({\n                    scrollTop: footerPosition\n                }, 500);\n              }\n            }\n            catch(exception){}\n            \n            if (tabHandle) {\n              tabHandle.disengage();\n              tabHandle = null;\n            } else {\n              tabHandle = ally.maintain.tabFocus({\n                context: header\n              });\n            }\n          });\n\n          let mobileToggler = document.querySelector('.navbar-toggler');\n          if (mobileToggler) {\n            weaverTakeover.activateTakeover('menu', mobileToggler, takeoverCover);\n            takeover.classList.add('mobile-active');\n          }\n\n          // SEARCH\n          let takeoverSearch = document.getElementById('takeover-search');\n          let searchButtons = document.querySelectorAll('a[data-target=takeover-search]');\n          let searchCover = document.getElementById('takeover-search-cover');\n\n          if (takeoverSearch) {\n\n            // hide when page loads or else get FOUC\n            takeoverSearch.classList.add('launch');\n            setTimeout(() => {\n              takeoverSearch.classList.remove('launch');\n            }, 1000);\n\n            if (searchButtons) {\n              searchButtons.forEach((searchButton) => {\n                weaverTakeover.activateTakeover('search', searchButton, searchCover);\n              });\n            }\n          }\n\n\n          // on mobile, accordion style links\n          if (window.innerWidth < 992) {\n            weaverTakeover.mobileTakeoverChanges(takeover);\n          }\n        }\n      });\n    }\n  };\n\n})(jQuery, Drupal);\n"],"file":"takeover.js"}