{"version":3,"sources":["../../js/takeover.js"],"names":["$","Drupal","behaviors","weaver_takeover","activateTakeover","type","button","cover","weaverTakeover","addEventListener","e","preventDefault","toggleTakeover","document","code","target","checkOpen","onclick","checkClosed","querySelector","classList","contains","mobileTakeoverChanges","takeover","childNav","parentLinks","querySelectorAll","forEach","parentLink","parentNode","toggle","body","header","getElementById","sideMenu","toggleButton","icon","weaver_animations","morphIcons","toggleTrueFalse","tooltip","trapFocus","element","attribute","attributeStatus","getAttribute","setAttribute","takeoverMenuLinks","link","attach","context","settings","once","each","add","takeoverButton","takeoverCover","setTimeout","remove","tabHandle","disengage","ally","maintain","tabFocus","mobileToggler","takeoverSearch","searchButtons","searchCover","searchButton","window","innerWidth","jQuery"],"mappings":"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","sourcesContent":["// special JS for the takeover menu\r\n\r\n(function ($, Drupal) {\r\n\r\n  'use strict';\r\n\r\n  Drupal.behaviors.weaver_takeover = {\r\n\r\n    activateTakeover: function(type, button, cover) {\r\n      const weaverTakeover = Drupal.behaviors.weaver_takeover;\r\n\r\n      // takeoverMenu icon change\r\n      button.addEventListener('click', function(e) {\r\n        e.preventDefault();\r\n        weaverTakeover.toggleTakeover(type, button, cover);\r\n      });\r\n\r\n      document.addEventListener('keydown', function(e) {\r\n        if (e.code == 'Enter' && e.target == button) {\r\n          weaverTakeover.toggleTakeover(type, button, cover);\r\n        }\r\n        if (e.code == 'Escape' && weaverTakeover.checkOpen(type)) {\r\n          weaverTakeover.toggleTakeover(type, button, cover);\r\n        }\r\n      });\r\n\r\n      // actions when takeoverCover clicked\r\n      if (cover) {\r\n        cover.onclick = function(e) {\r\n          e.preventDefault();\r\n          weaverTakeover.toggleTakeover(type, button, cover);\r\n        };\r\n      }\r\n    },\r\n\r\n    checkClosed: function(type) {\r\n        if (document.querySelector('body').classList.contains('takeover-' + type + '-open')) {\r\n            return false;\r\n        }\r\n        return true;\r\n    },\r\n\r\n    checkOpen: function(type) {\r\n        if (document.querySelector('body').classList.contains('takeover-' + type + '-open')) {\r\n            return true;\r\n        }\r\n        return false;\r\n    },\r\n\r\n    mobileTakeoverChanges: function(takeover) {\r\n      let childNav;\r\n      let parentLinks = takeover.querySelectorAll('ul.nav > li.nav-item > .nav-link');\r\n      \r\n      if (parentLinks) {\r\n        parentLinks.forEach((parentLink) => {\r\n          parentLink.addEventListener('click', (e) => {\r\n            e.preventDefault();\r\n            childNav = parentLink.parentNode.querySelector('ul.menu');\r\n            childNav.classList.toggle('active');\r\n          });\r\n        });\r\n      }\r\n    },\r\n\r\n    toggleTakeover: function(type, button, cover) {\r\n      const weaverTakeover = Drupal.behaviors.weaver_takeover;\r\n\r\n      const body = document.querySelector('body');\r\n      const header = document.getElementById('header');\r\n      const sideMenu = document.getElementById('side-menu');\r\n      let takeover = document.getElementById('takeover-' + type);\r\n      let toggleButton;\r\n      let icon;\r\n\r\n      // ensure all other takeovers are closed\r\n      switch (type) {\r\n        case 'menu':\r\n          toggleButton = document.querySelector('#takeover-button a');\r\n\r\n          if (this.checkOpen('search')) {\r\n            this.toggleTakeover('search', button, cover);\r\n           }\r\n          icon = 'bars';\r\n                      \r\n          break;\r\n  \r\n        case 'search':\r\n          toggleButton = document.querySelector('#search-button a');\r\n\r\n          if (this.checkOpen('menu')) {\r\n            this.toggleTakeover('menu', button, cover);\r\n          }\r\n          icon = 'search';\r\n\r\n          break;\r\n      }\r\n\r\n      // animate icon\r\n      Drupal.behaviors.weaver_animations.morphIcons(icon, 'close');\r\n\r\n      // expand/collapse menu\r\n      body.classList.toggle('takeover-' + type + '-open');\r\n      body.classList.toggle('takeover-' + type + '-closed');\r\n\r\n      // take care of accessibility\r\n      this.toggleTrueFalse(takeover, 'aria-hidden');\r\n      this.toggleTrueFalse(toggleButton, 'aria-expanded');\r\n\r\n      // close tooltips\r\n      $('[data-toggle=\"tooltip\"]').tooltip('hide');\r\n      \r\n      this.trapFocus(type);\r\n    },\r\n\r\n    toggleTrueFalse: function(element, attribute) {\r\n\r\n        let attributeStatus = element.getAttribute(attribute);\r\n\r\n        if (attributeStatus == 'true') {\r\n          element.setAttribute(attribute, 'false');\r\n        } else {\r\n          element.setAttribute(attribute, 'true');\r\n        }\r\n    },\r\n\r\n    trapFocus: function(type) {\r\n\r\n      const takeoverMenuLinks = document.getElementById('takeover-menu').querySelectorAll('a.nav-link');\r\n\r\n      // put all menu items into or out of tabindex\r\n      if (this.checkOpen(type)) {\r\n\r\n        switch (type) {\r\n\r\n          case 'menu':\r\n\r\n            takeoverMenuLinks.forEach((link) => {\r\n                link.setAttribute('tabindex', 0);\r\n            });\r\n\r\n            break;\r\n        }\r\n\r\n      } else {\r\n\r\n        switch (type) {\r\n\r\n          case 'menu':\r\n            takeoverMenuLinks.forEach((link) => {\r\n                link.setAttribute('tabindex', -1);\r\n            });\r\n\r\n            break;\r\n        }\r\n      }\r\n    },\r\n\r\n    attach: function (context, settings) {\r\n\r\n      // ensures javascript runs only once per page load and not with every ajax call\r\n      $('body', context).once('weaver_takeover').each(function () { \r\n      \t\r\n        const weaverTakeover = Drupal.behaviors.weaver_takeover;\r\n\r\n        // add closed classes\r\n        const body = document.querySelector('body');\r\n        body.classList.add('takeover-menu-closed');\r\n        body.classList.add('takeover-search-closed');\r\n\r\n        // MENU\r\n        let takeover = document.getElementById('takeover-menu');\r\n        let takeoverButton = document.getElementById('takeover-button').querySelector('a[data-target=takeover-menu]');\r\n        let takeoverCover = document.getElementById('takeover-menu-cover');\r\n       \r\n      \tif (takeover) {\r\n\r\n          // hide when page loads or else get FOUC\r\n          takeover.classList.add('launch');\r\n          setTimeout(() => {\r\n            takeover.classList.remove('launch');\r\n          }, 1000);\r\n\r\n      \t\tif (takeoverButton) {\r\n            weaverTakeover.activateTakeover('menu', takeoverButton, takeoverCover);\r\n          }\r\n\r\n          var tabHandle;\r\n          takeoverButton.addEventListener('click', function(e) {\r\n            e.preventDefault();\r\n\r\n            if (tabHandle) {\r\n              tabHandle.disengage();\r\n              tabHandle = null;\r\n            } else {\r\n              tabHandle = ally.maintain.tabFocus({\r\n                context: header\r\n              });\r\n            }\r\n          });\r\n\r\n          let mobileToggler = document.querySelector('.navbar-toggler');\r\n          if (mobileToggler) {\r\n            weaverTakeover.activateTakeover('menu', mobileToggler, takeoverCover);\r\n            takeover.classList.add('mobile-active');\r\n          }\r\n\r\n          // SEARCH\r\n          let takeoverSearch = document.getElementById('takeover-search');\r\n          let searchButtons = document.querySelectorAll('a[data-target=takeover-search]');\r\n          let searchCover = document.getElementById('takeover-search-cover');\r\n\r\n          if (takeoverSearch) {\r\n\r\n            // hide when page loads or else get FOUC\r\n            takeoverSearch.classList.add('launch');\r\n            setTimeout(() => {\r\n              takeoverSearch.classList.remove('launch');\r\n            }, 1000);\r\n\r\n            if (searchButtons) {\r\n              searchButtons.forEach((searchButton) => {\r\n                weaverTakeover.activateTakeover('search', searchButton, searchCover);\r\n              });\r\n            }\r\n          }\r\n\r\n\r\n          // on mobile, accordion style links\r\n          if (window.innerWidth < 992) {\r\n            weaverTakeover.mobileTakeoverChanges(takeover);\r\n          }\r\n          window.addEventListener('resize', function() {\r\n            if (window.innerWidth < 992) {\r\n              weaverTakeover.mobileTakeoverChanges(takeover);\r\n            }\r\n          });\r\n        }\r\n      });\r\n    }\r\n  };\r\n\r\n})(jQuery, Drupal);\r\n"],"file":"takeover.js"}